# 바이블 스픽 2.0 - 기능 설계서

## 1. 온보딩 플로우

### 1.1 첫 실행 화면 흐름

```
[스플래시] → [웰컴 슬라이드 x3] → [프로필 설정] → [튜토리얼] → [메인]
```

### 1.2 웰컴 슬라이드

| 슬라이드 | 제목 | 설명 | 이미지 |
|----------|------|------|--------|
| 1 | AI 튜터와 함께 | "음소 단위 발음 교정으로 원어민처럼" | 발음 분석 UI |
| 2 | 3단계 쉐도잉 | "듣고, 따라하고, 암송까지" | 3단계 아이콘 |
| 3 | 함께 성장 | "교회 그룹과 달란트 랭킹" | 랭킹 화면 |

### 1.3 프로필 설정
```dart
class ProfileSetupData {
  String nickname;      // 필수: 2-10자
  String? groupCode;    // 선택: 초대 코드 입력
  bool createNewGroup;  // 새 그룹 생성 여부
  String? newGroupName; // 새 그룹명
}
```

**UI 구성**:
- 닉네임 입력 (TextField)
- 그룹 옵션: "그룹 없이 시작" / "초대 코드 입력" / "새 그룹 만들기"
- 시작하기 버튼

### 1.4 튜토리얼 (첫 구절 체험)
- 말라기 1:1 자동 선택
- Stage 1만 체험
- 주요 UI 요소 하이라이트
- 완료 후 "본격적으로 시작하기" 버튼

---

## 2. 메인 화면 (MainMenuScreen)

### 2.1 레이아웃

```
┌─────────────────────────────────┐
│  👤 닉네임님              ⚙️    │  ← 헤더
├─────────────────────────────────┤
│  🏆 달란트: 15                  │  ← 달란트 배지
├─────────────────────────────────┤
│                                 │
│  ┌───────────┐ ┌───────────┐   │
│  │  📖       │ │  📝       │   │
│  │ 암송 연습  │ │ 단어 공부  │   │
│  │ 진행: 12% │ │ 진행: 8%  │   │
│  └───────────┘ └───────────┘   │
│                                 │
│  ┌───────────┐ ┌───────────┐   │
│  │  🏅       │ │  📊       │   │
│  │ 그룹 랭킹  │ │ 내 통계    │   │
│  │ 3위/12명  │ │ 이번주 5일 │   │
│  └───────────┘ └───────────┘   │
│                                 │
├─────────────────────────────────┤
│  💡 오늘의 추천 구절            │
│  "Ephesians 2:8 - 은혜로..."    │
│  [바로 학습하기]                │
└─────────────────────────────────┘
```

### 2.2 기능 카드

| 카드 | 아이콘 | 제목 | 부제 | 탭 동작 |
|------|--------|------|------|---------|
| 암송 연습 | 📖 | 암송 연습 | 전체 진행률 % | → BookSelectionScreen |
| 단어 공부 | 📝 | 단어 공부 | 학습 단어 수 | → WordStudyHomeScreen |
| 그룹 랭킹 | 🏅 | 그룹 랭킹 | 내 순위/전체 | → RankingScreen |
| 내 통계 | 📊 | 내 통계 | 이번주 학습일 | → StatsScreen (신규) |

### 2.3 오늘의 추천 구절
- 알고리즘:
  1. 마지막 학습 구절의 다음 구절
  2. Stage 2/3 미완료 구절 우선
  3. 랜덤 새 구절

---

## 3. 성경책/장 선택 (로드맵 스타일)

### 3.1 BookSelectionScreen

```
┌─────────────────────────────────┐
│  ← 성경책 선택                  │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │ 📘 말라기 (Malachi)      │   │
│  │ ████████░░ 80%          │   │
│  │ 4장 중 3장 완료           │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │ 📗 에베소서 (Ephesians)  │   │
│  │ ██░░░░░░░░ 20%          │   │
│  │ 6장 중 1장 완료           │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │ 📕 히브리서 (Hebrews)    │   │
│  │ 🔒 잠금 (에베소서 완료 시) │   │
│  └─────────────────────────┘   │
│                                 │
└─────────────────────────────────┘
```

### 3.2 ChapterSelectionScreen (로드맵 UI)

```
┌─────────────────────────────────┐
│  ← 말라기                       │
├─────────────────────────────────┤
│                                 │
│        ●━━━━━━●                │
│       1장    2장                │
│      완료   진행중              │
│              │                  │
│              ┃                  │
│        ●━━━━━◐                 │
│       4장    3장                │
│      잠금   잠금                │
│                                 │
├─────────────────────────────────┤
│  📍 현재 위치: 2장              │
│  ────────────────────────────   │
│  구절 1-5:  ●●●◐○             │
│  구절 6-10: ○○○○○             │
│  [2장 계속하기]                 │
└─────────────────────────────────┘
```

**로드맵 노드 상태**:
- ● 완료 (초록): 모든 구절 Stage 3 완료
- ◐ 진행중 (파랑): 일부 구절 학습 중
- ○ 미시작 (회색): 학습 전
- 🔒 잠금: 이전 장 완료 필요

---

## 4. 구절 연습 (VersePracticeScreen)

### 4.1 3단계 학습 UI

#### Stage 1: Listen & Repeat (듣고 따라하기)

```
┌─────────────────────────────────┐
│  ← 말라기 1:2                   │
│  [Stage 1/3] Listen & Repeat    │
├─────────────────────────────────┤
│                                 │
│  "I have loved you,"            │
│   says the LORD.                │
│                                 │
│  ─────────────────────────────  │
│  "여호와께서 이르시되             │
│   내가 너희를 사랑하였노라"        │
│                                 │
├─────────────────────────────────┤
│  🎧 듣기        🐢 0.8x         │
│  [▶️ 재생]     [🔄 반복]        │
├─────────────────────────────────┤
│                                 │
│     [🎤 따라 말하기]             │
│                                 │
│  💡 TIP: 전체 문장을 보면서       │
│      따라 말해보세요              │
└─────────────────────────────────┘
```

#### Stage 2: Key Expressions (핵심 표현)

```
┌─────────────────────────────────┐
│  ← 말라기 1:2                   │
│  [Stage 2/3] Key Expressions    │
├─────────────────────────────────┤
│                                 │
│  "I have _______ you,"          │
│   says the _______.             │
│                                 │
│  💡 힌트: loved, LORD           │
│                                 │
├─────────────────────────────────┤
│  [▶️ 힌트 듣기]                  │
├─────────────────────────────────┤
│                                 │
│     [🎤 말하기]                  │
│                                 │
│  💡 TIP: 빈칸의 단어를           │
│      기억하며 말해보세요          │
└─────────────────────────────────┘
```

**빈칸 선정 알고리즘**:
1. 핵심 명사/동사 (loved, says, LORD)
2. 구절당 2-4개 단어
3. 난이도: 쉬움(1개) → 어려움(4개)

#### Stage 3: Real Speak (실전 암송)

```
┌─────────────────────────────────┐
│  ← 말라기 1:2                   │
│  [Stage 3/3] Real Speak 🏆      │
├─────────────────────────────────┤
│                                 │
│            📖                   │
│     성경을 보지 않고             │
│     암송해 보세요                │
│                                 │
│  ─────────────────────────────  │
│  "여호와께서 이르시되             │
│   내가 너희를 사랑하였노라"        │
│   (한글만 참고 가능)              │
│                                 │
├─────────────────────────────────┤
│                                 │
│     [🎤 암송 시작]               │
│                                 │
│  ⚠️ 정확도 85% 이상 필요         │
└─────────────────────────────────┘
```

### 4.2 녹음 중 UI

```
┌─────────────────────────────────┐
│        🔴 녹음 중...             │
│        00:03 / 00:30            │
│                                 │
│  ▁▃▅▇▅▃▁▃▅▇▅▃▁                │
│       (음성 파형)                │
│                                 │
│  [⏹️ 완료]     [❌ 취소]         │
└─────────────────────────────────┘
```

### 4.3 결과 화면

```
┌─────────────────────────────────┐
│           🎉 A+                 │
│         정확도 95%               │
├─────────────────────────────────┤
│  📊 상세 점수                    │
│  ├─ 정확도:  ████████░░ 95%    │
│  ├─ 유창성:  ███████░░░ 88%    │
│  └─ 운율:   ██████░░░░ 82%    │
├─────────────────────────────────┤
│  📝 AI 피드백                    │
│  ─────────────────────────────  │
│  "loved"의 발음이 정확했어요!     │
│  "LORD"에서 r 발음을 좀 더       │
│  강하게 해보세요.                 │
│                                 │
│  💡 발음 팁                      │
│  • /r/: 혀를 뒤로 말면서 발음     │
├─────────────────────────────────┤
│  🎯 단어별 상세                  │
│  I [100%] have [95%] loved [92%]│
│  you [88%] says [90%] the [100%]│
│  LORD [78%] ← 연습 필요          │
├─────────────────────────────────┤
│  [🔄 다시 도전]  [➡️ 다음 단계]   │
│                                 │
│  🏆 달란트 +1 획득!              │
└─────────────────────────────────┘
```

### 4.4 발음 상세 팝업 (단어 탭 시)

```
┌─────────────────────────────────┐
│  "LORD" 발음 분석                │
├─────────────────────────────────┤
│  발음 기호: /lɔːrd/              │
│  한글 힌트: [로ㅓ드]              │
│                                 │
│  음소별 점수:                    │
│  ├─ l: ████████░░ 95%          │
│  ├─ ɔ: ███████░░░ 85%          │
│  ├─ r: █████░░░░░ 65% ⚠️       │
│  └─ d: ████████░░ 90%          │
│                                 │
│  💡 r 발음 팁                    │
│  혀끝을 입천장에 닿지 않게        │
│  뒤로 말면서 소리내세요           │
│                                 │
│  [🎧 원어민 발음 듣기]            │
│  [🔄 닫기]                       │
└─────────────────────────────────┘
```

---

## 5. 단어 학습 (WordStudyScreen)

### 5.1 단어 목록

```
┌─────────────────────────────────┐
│  ← 말라기 1장 단어               │
│  [전체] [미학습] [학습중] [완료]  │
├─────────────────────────────────┤
│  ┌─────────────────────────┐   │
│  │ loved     [학습중]       │   │
│  │ 사랑했다                 │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ covenant  [미학습]       │   │
│  │ 언약                    │   │
│  └─────────────────────────┘   │
│  ...                            │
├─────────────────────────────────┤
│  [📚 플래시카드] [📝 퀴즈]       │
└─────────────────────────────────┘
```

### 5.2 플래시카드

```
┌─────────────────────────────────┐
│  ← 플래시카드    3/15           │
├─────────────────────────────────┤
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │      covenant           │   │
│  │                         │   │
│  │      (탭해서 뒤집기)      │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│    [😕 모름]  [🤔 어려움]  [😊 알아]│
│                                 │
└─────────────────────────────────┘
```

### 5.3 퀴즈

```
┌─────────────────────────────────┐
│  ← 단어 퀴즈    Q5/10           │
├─────────────────────────────────┤
│                                 │
│     "covenant"의 뜻은?          │
│                                 │
│  ┌─────────────────────────┐   │
│  │ A. 축복                  │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ B. 언약                  │   │ ← 정답
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ C. 제물                  │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │ D. 율법                  │   │
│  └─────────────────────────┘   │
│                                 │
└─────────────────────────────────┘
```

---

## 6. 그룹 & 랭킹

### 6.1 그룹 관리

```
┌─────────────────────────────────┐
│  ← 내 그룹                      │
├─────────────────────────────────┤
│  🏛️ 서울중앙교회 청년부          │
│  멤버: 12명                     │
│  총 달란트: 156                 │
│                                 │
│  📋 초대 코드: ABC123           │
│  [📤 코드 공유하기]              │
├─────────────────────────────────┤
│  👥 멤버                        │
│  ─────────────────────────────  │
│  1. 🥇 김철수    45 달란트       │
│  2. 🥈 이영희    38 달란트       │
│  3. 🥉 박민수    32 달란트       │
│  4.    나        28 달란트 ← 나 │
│  ...                            │
└─────────────────────────────────┘
```

### 6.2 주간 랭킹

```
┌─────────────────────────────────┐
│  ← 이번주 랭킹                   │
│  [우리 그룹] [전체]              │
├─────────────────────────────────┤
│           🏆                    │
│      이번주 1위                  │
│        김철수                   │
│      +12 달란트                 │
├─────────────────────────────────┤
│  🥈 이영희     +8               │
│  🥉 박민수     +6               │
│  4. 나        +5  ← 4위!       │
│  5. 최지영     +3               │
├─────────────────────────────────┤
│  💡 3 달란트 더 모으면 3위!      │
└─────────────────────────────────┘
```

---

## 7. 설정

### 7.1 설정 화면

```
┌─────────────────────────────────┐
│  ← 설정                         │
├─────────────────────────────────┤
│  👤 프로필                       │
│  ├─ 닉네임: 홍길동        [변경] │
│  └─ 그룹: 서울중앙교회    [변경] │
├─────────────────────────────────┤
│  🎧 학습 설정                    │
│  ├─ TTS 속도: 0.8x       [조절] │
│  ├─ 자동 재생: ON        [토글] │
│  └─ 발음 평가 엄격도: 보통 [선택]│
├─────────────────────────────────┤
│  💳 구독                         │
│  ├─ 현재: 무료                  │
│  └─ [프리미엄 업그레이드]         │
├─────────────────────────────────┤
│  ℹ️ 정보                         │
│  ├─ 버전: 1.0.0                 │
│  ├─ 이용약관                    │
│  ├─ 개인정보처리방침             │
│  └─ 문의하기                    │
├─────────────────────────────────┤
│  [🚪 로그아웃]                   │
└─────────────────────────────────┘
```

---

## 8. 알림 시스템

### 8.1 푸시 알림

| 타입 | 트리거 | 메시지 예시 |
|------|--------|-------------|
| 학습 리마인더 | 매일 오전 8시 | "오늘의 성경 구절이 기다려요! 📖" |
| 연속 학습 | 3일 미접속 | "연속 학습 기록이 끊어질 수 있어요 😢" |
| 그룹 활동 | 그룹원 달란트 획득 | "김철수님이 달란트를 획득했어요!" |
| 랭킹 변동 | 순위 상승 | "축하해요! 그룹 랭킹 3위로 올랐어요 🎉" |

### 8.2 인앱 알림

```
┌─────────────────────────────────┐
│ 🎉 축하합니다!                   │
│ 말라기 1장을 완료했어요!          │
│                                 │
│ +5 달란트 획득                   │
│                                 │
│        [다음 장 시작하기]         │
└─────────────────────────────────┘
```

---

## 9. 오류 처리 UX

### 9.1 네트워크 오류

```
┌─────────────────────────────────┐
│         📡 연결 오류             │
│                                 │
│   인터넷 연결을 확인해주세요      │
│                                 │
│   오프라인 모드로 학습할 수 있어요 │
│   (캐시된 구절만 가능)            │
│                                 │
│   [🔄 다시 시도] [📴 오프라인 모드]│
└─────────────────────────────────┘
```

### 9.2 마이크 권한 없음

```
┌─────────────────────────────────┐
│         🎤 마이크 필요           │
│                                 │
│   발음 평가를 위해               │
│   마이크 권한이 필요해요          │
│                                 │
│   [⚙️ 설정으로 이동]             │
└─────────────────────────────────┘
```

### 9.3 발음 평가 실패

```
┌─────────────────────────────────┐
│         ⚠️ 평가 실패             │
│                                 │
│   음성이 잘 들리지 않았어요       │
│                                 │
│   💡 팁:                        │
│   • 조용한 환경에서 녹음해주세요  │
│   • 마이크에 가까이 말해주세요    │
│                                 │
│   [🔄 다시 시도]                 │
└─────────────────────────────────┘
```

---

## 10. 접근성

### 10.1 지원 기능

| 기능 | 구현 |
|------|------|
| 다크 모드 | 시스템 설정 연동 |
| 폰트 크기 | 설정에서 조절 (소/중/대) |
| VoiceOver/TalkBack | 모든 버튼에 label |
| 색맹 지원 | 색상 외 아이콘으로 상태 표시 |

### 10.2 다크 모드

- 배경: #121212
- 카드: #1E1E1E
- 텍스트: #FFFFFF (87% opacity)
- 강조색: #BB86FC (보라)
